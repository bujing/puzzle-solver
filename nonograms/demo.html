<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Nonograms Solver</title>
  <link rel="stylesheet" href="https://unpkg.com/poplar-css/dist/poplar.css">
  <style>
    body {
      background-color: #e8e8e8;
    }

    .puzzle {
      display: grid;
      grid-template-columns: auto auto 1fr;
      grid-template-rows: auto 1fr;
    }

    .horizontal td {
      vertical-align: bottom;
    }
    .horizontal td:nth-child(5n):not(:last-child) {
      border-right: 2px solid transparent;
    }
    .vertical tr:nth-child(5n):not(:last-child) {
      border-bottom: 2px solid transparent;
    }
    .vertical td {
      display: flex;
      justify-content: flex-end;
    }

    .grid tr:nth-child(5n):not(:last-child) {
      border-bottom: 2px solid #333;
    }
    .grid td:nth-child(5n):not(:last-child) {
      border-right: 2px solid #333;
    }

    .cell {
      font-size: 12px;
      line-height: 16px;
      padding: 0;
      text-align: center;
    }
    .cell input {
      height: 12px;
      padding: 0;
      text-align: center;
      vertical-align: top;
      width: 12px;
    }
    .cell-item {
      height: 16px;
      width: 16px;
    }

    .fill {
      background-color: #333;
    }
    .empty {
      background-color: #ccc;
    }

    .btn button {
      display: block;
      font-size: 14px;
      height: 32px;
      line-height: 30px;
      margin-top: 10px;
      padding: 0;
      width: 100%;
    }
  </style>
</head>
<body>

  <div id="root"></div>

  <script src="nonograms.js"></script>
  <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script type="text/babel">
    const { Fragment, useState, useEffect, useCallback } = React

    const App = () => {
      const [numbers, setNumbers] = useState([
        [[12, 6, 9], [9, 2, 10, 6], [8, 3, 3, 5, 5], [7, 2, 1, 2, 3, 3, 4], [7, 2, 2, 2, 3, 3, 2, 2, 3], [6, 2, 3, 1, 4, 1, 2, 4, 3], [6, 2, 3, 1, 2, 2, 2, 3, 2], [6, 2, 4, 1, 2, 2, 1, 2, 1, 3, 2], [5, 2, 5, 2, 3, 2, 5, 2], [5, 2, 5, 1, 2, 6, 5, 2], [4, 3, 6, 3, 2, 2, 3, 2], [3, 2, 3, 3, 3, 3, 3, 2], [2, 1, 1, 3, 4, 5, 2, 3], [1, 1, 2, 2, 9, 3, 3], [3, 3, 5, 4, 3], [3, 5, 6, 4], [1, 5, 9, 4], [3, 2, 10, 6, 2], [8, 1, 10, 2, 1], [1, 9, 9, 3, 3], [2, 1, 8, 2, 3, 11], [3, 9, 2, 6, 8], [1, 2, 1, 2, 4, 2, 6, 3, 3], [2, 2, 4, 2, 3, 2, 2, 5], [5, 2, 6, 1, 3, 2, 2, 1, 4], [7, 1, 8, 3, 2, 4, 2], [4, 2, 4, 1, 1, 2, 8], [9, 1, 4, 2, 1, 1, 7], [5, 3, 3, 2, 1, 3, 4, 1], [7, 2, 3, 2, 6, 2, 2], [1, 16, 2, 6, 3], [1, 8, 15, 4], [2, 5, 3, 3, 6], [3, 3, 8], [4, 6, 4], [7, 5], [12, 9, 1, 1], [15, 15], [17, 15], [19, 8]],
        [[8, 8, 10], [10, 2, 2, 3, 8], [11, 3, 2, 4, 7], [11, 3, 1, 6, 6], [12, 3, 6, 5], [13, 5, 7, 5], [5, 3, 5, 1, 4, 5], [3, 4, 1, 5, 4], [2, 5, 1, 3, 4], [1, 5, 7, 1, 4, 4], [1, 9, 3, 2, 2, 3, 4], [1, 3, 1, 1, 4, 1, 3, 4], [2, 3, 5, 7, 1, 3, 3], [1, 7, 5, 7, 4, 3], [1, 9, 3, 4, 3, 3], [12, 3, 5, 1, 2], [2, 3, 3, 3, 10, 2], [1, 5, 2, 2, 2, 12, 1], [3, 4, 2, 5, 3, 4, 1, 1], [2, 4, 2, 1, 3, 2, 5], [2, 7, 2, 1, 3, 8, 1], [2, 3, 2, 2, 1, 4, 5, 1, 4], [2, 3, 2, 2, 2, 4, 2, 1, 3], [2, 1, 3, 1, 2, 1, 3, 7, 2, 3], [2, 3, 2, 1, 2, 1, 2, 4, 3, 2, 1], [3, 1, 2, 1, 3, 2, 1, 3, 2, 1, 2, 4], [3, 2, 2, 3, 2, 1, 2, 3, 2, 2, 3], [2, 6, 2, 4, 6, 4, 3], [4, 4, 3, 4, 4, 4, 3], [3, 3, 4, 3, 1, 1, 3, 2], [1, 1, 5, 4, 2, 2, 2, 3, 3], [1, 3, 2, 4, 5, 4, 1, 4], [1, 12, 3, 6, 1, 3], [1, 9, 4, 6, 1, 3], [2, 5, 3, 1, 4, 2, 3], [3, 3, 2, 2, 2, 4], [4, 2, 2, 5, 4, 3], [6, 5, 6, 5, 3], [18, 4, 6, 2], [19, 1, 7, 1]]
      ])
      const [grid, setGrid] = useState(() => {
        return Array(numbers[0].length).fill('').map(() => Array(numbers[1].length).fill(0))
      })

      const solution = useCallback(() => {
        const res = new Nonograms(numbers)
        setGrid(res.grid)
        console.log(res)
      }, [numbers])

      const reset = useCallback(() => {
        setGrid(Array(numbers[0]).fill('').map(() => Array(numbers[1]).fill(0)))
      }, [])

      return (
        <div className="puzzle">
          <div></div>
          <table className="horizontal">
            <tbody>
              <tr>
                {numbers[1].map((item, i) => (
                  <td key={i} className="cell">
                    {item.map((num, j) => (
                      <div key={j} className="cell-item">{num}</div>
                    ))}
                  </td>
                ))}
              </tr>
            </tbody>
          </table>
          <div></div>

          <table className="vertical">
            <tbody>
              {numbers[0].map((item, i) => (
                <tr key={i}>
                  <td className="cell">
                    {item.map((num, j) => (
                      <div key={j} className="cell-item">{num}</div>
                    ))}
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
          <div>
            <table className="grid">
              <tbody>
                {grid.map((r, i) => (
                  <tr key={i}>
                    {r.map((c, j) => (
                      <td key={j} className="cell">
                        <input className={grid[i][j] === 1 ? 'fill' : (grid[i][j] === -1 ? 'empty' : '')} readOnly />
                      </td>
                    ))}
                  </tr>
                ))}
              </tbody>
            </table>
            <div className="btn">
              <button className="button-black" onClick={solution}>解题</button>
              <button className="button-white" onClick={reset}>重置</button>
            </div>
          </div>
        </div>
      )
    }

    ReactDOM.render(<App />, document.querySelector('#root'))
  </script>
  <script>
    const nonograms = []
    // 5 * 5
    nonograms.push([
      [[3], [3, 1], [1, 2], [1, 1], [1]],
      [[3], [2], [2, 1], [1], [4]]
    ])
    // 10 * 10
    nonograms.push([
      [[8], [7], [1, 3], [1, 1, 1], [4, 3], [3, 2], [1, 4], [1, 2], [3], [5]],
      [[1, 1], [1, 3], [1, 2, 1], [2, 2, 1], [2, 1], [4, 2], [2, 4], [5, 4], [2, 3], [6]]
    ])
    // 15 * 15
    nonograms.push([
      [[4, 5], [1, 5], [2, 6], [3, 9], [4, 6], [3, 1, 4], [4, 1, 1], [4, 2, 3], [4, 5], [2, 3, 3, 1], [1, 2, 5], [3, 3], [3], [1, 2], [2, 1, 1, 2, 1]],
      [[8, 1], [1, 8, 2], [9], [1, 1, 3, 1], [1, 3], [1, 3, 1], [7, 1, 1], [5], [5, 1], [5, 1], [6, 4, 2], [1, 9, 2], [1, 1, 6], [1, 1, 3, 1], [1, 4]]
    ])
    // 20 * 20
    nonograms.push([
      [[4, 3], [3, 2], [4, 2, 1], [5, 3, 3], [8, 1, 1, 1, 1], [8, 1, 3, 1, 1], [8, 1, 3, 3], [5, 1, 1, 2, 3], [2, 2, 3, 3], [3], [2, 3, 3, 2], [5, 3, 4, 1], [7, 5], [2, 5, 6, 1], [2, 1, 6, 1], [3, 6, 1], [2, 4, 1], [3, 2, 1, 1], [2, 6, 1, 1], [1, 2, 5, 3]],
      [[8, 5], [8, 5], [9, 2], [1, 7, 8], [5, 3, 5], [3, 2, 1, 1], [4, 3, 1], [5, 1, 1, 1, 1], [3, 3, 4], [3, 6, 5], [1, 3, 4, 1], [1, 3, 4, 2], [2, 4, 2], [6, 4, 2], [1, 2, 4, 3], [3, 1, 3, 2], [7], [5, 2], [3, 2, 1], [4, 1, 3]]
    ])
    // 25 * 25
    nonograms.push([
      [[4, 3], [4, 1, 1, 2], [6, 1, 1, 2, 1], [4, 1, 1, 2], [3, 1, 1, 4], [2, 1, 1, 2, 1], [2, 6, 1, 2, 2], [10, 3, 4], [7, 3, 1, 1, 3], [7, 1, 6, 3], [3, 1, 6], [6, 13], [6, 1, 13], [7, 11], [4, 1, 1, 10], [1, 4, 2, 2, 2, 7], [5, 3, 6], [3, 1, 2, 5], [5, 3, 8], [6, 7], [8, 1, 1, 4], [7, 6], [3, 1, 1, 1, 2], [1, 1, 1], [8]],
      [[4, 3, 6], [5, 3, 7], [12, 8], [3, 4, 2, 3, 5], [1, 3, 11], [1, 11, 5], [4, 4, 2], [5, 3, 1, 2], [3, 1, 1], [5, 4, 1, 1], [1, 3, 3, 1], [3, 1, 1, 4, 2], [1, 1, 4, 5, 1], [3, 5, 1, 1, 3], [3, 5, 1], [3, 7, 3], [1, 1, 7, 1, 1], [9, 1, 1, 2], [1, 5, 2, 1], [6, 3, 1], [10, 1], [1, 10, 1], [1, 3, 10, 1], [2, 5, 9], [3, 4, 9]]
    ])
    // 30 * 30
    nonograms.push([
      [[3, 3, 2, 6], [3, 1, 2, 1, 6], [3, 1, 1, 2, 6], [3, 1, 3, 2, 6, 3], [5, 4, 2, 6], [3, 6, 9], [2, 3, 3], [2, 4, 3, 2], [3, 2, 3, 2], [3, 3, 1, 2, 2], [1, 1, 2, 6, 2], [2, 3, 3, 6, 3], [7, 4, 6, 1, 3], [1, 6, 11, 3], [8, 9, 1], [2, 8, 7, 2], [2, 12, 6, 2], [3, 2, 5, 6, 3], [3, 6, 5, 6], [3, 4, 2, 7], [1, 1, 3, 4], [2, 1, 4, 1, 1, 1], [1, 2, 1, 2, 1], [1, 1, 6, 1], [1, 3, 1, 1, 1], [4, 4, 10, 1], [2, 5, 6, 3], [2, 4, 12], [3, 5, 6, 4], [4, 1, 4, 6, 4]],
      [[5, 9, 3, 5], [5, 3, 2, 3, 1, 5], [6, 3, 3, 3, 2], [2, 4, 1, 1], [1, 3, 6], [8, 1], [9, 2, 1], [6, 1, 4, 3, 5], [8, 5, 5], [3, 1, 1, 3, 2, 5], [5, 4, 2, 1, 4], [2, 5, 3], [2, 4, 3, 4], [1, 3, 4, 4], [2, 10, 5], [2, 8, 6], [3, 3, 12], [4, 9, 9], [1, 1, 9, 1, 1, 1, 1], [2, 2, 9, 1, 1, 1, 3], [7, 4, 5, 1, 1, 3], [11, 4, 1, 7], [10, 3, 5], [3, 1, 4], [6, 1, 2], [4, 3, 1], [3, 7, 6], [4, 15], [4, 3, 4], [4, 2, 3, 1]]
    ])
    // 40 * 40
    nonograms.push([
      [[12, 6, 9], [9, 2, 10, 6], [8, 3, 3, 5, 5], [7, 2, 1, 2, 3, 3, 4], [7, 2, 2, 2, 3, 3, 2, 2, 3], [6, 2, 3, 1, 4, 1, 2, 4, 3], [6, 2, 3, 1, 2, 2, 2, 3, 2], [6, 2, 4, 1, 2, 2, 1, 2, 1, 3, 2], [5, 2, 5, 2, 3, 2, 5, 2], [5, 2, 5, 1, 2, 6, 5, 2], [4, 3, 6, 3, 2, 2, 3, 2], [3, 2, 3, 3, 3, 3, 3, 2], [2, 1, 1, 3, 4, 5, 2, 3], [1, 1, 2, 2, 9, 3, 3], [3, 3, 5, 4, 3], [3, 5, 6, 4], [1, 5, 9, 4], [3, 2, 10, 6, 2], [8, 1, 10, 2, 1], [1, 9, 9, 3, 3], [2, 1, 8, 2, 3, 11], [3, 9, 2, 6, 8], [1, 2, 1, 2, 4, 2, 6, 3, 3], [2, 2, 4, 2, 3, 2, 2, 5], [5, 2, 6, 1, 3, 2, 2, 1, 4], [7, 1, 8, 3, 2, 4, 2], [4, 2, 4, 1, 1, 2, 8], [9, 1, 4, 2, 1, 1, 7], [5, 3, 3, 2, 1, 3, 4, 1], [7, 2, 3, 2, 6, 2, 2], [1, 16, 2, 6, 3], [1, 8, 15, 4], [2, 5, 3, 3, 6], [3, 3, 8], [4, 6, 4], [7, 5], [12, 9, 1, 1], [15, 15], [17, 15], [19, 8]],
      [[8, 8, 10], [10, 2, 2, 3, 8], [11, 3, 2, 4, 7], [11, 3, 1, 6, 6], [12, 3, 6, 5], [13, 5, 7, 5], [5, 3, 5, 1, 4, 5], [3, 4, 1, 5, 4], [2, 5, 1, 3, 4], [1, 5, 7, 1, 4, 4], [1, 9, 3, 2, 2, 3, 4], [1, 3, 1, 1, 4, 1, 3, 4], [2, 3, 5, 7, 1, 3, 3], [1, 7, 5, 7, 4, 3], [1, 9, 3, 4, 3, 3], [12, 3, 5, 1, 2], [2, 3, 3, 3, 10, 2], [1, 5, 2, 2, 2, 12, 1], [3, 4, 2, 5, 3, 4, 1, 1], [2, 4, 2, 1, 3, 2, 5], [2, 7, 2, 1, 3, 8, 1], [2, 3, 2, 2, 1, 4, 5, 1, 4], [2, 3, 2, 2, 2, 4, 2, 1, 3], [2, 1, 3, 1, 2, 1, 3, 7, 2, 3], [2, 3, 2, 1, 2, 1, 2, 4, 3, 2, 1], [3, 1, 2, 1, 3, 2, 1, 3, 2, 1, 2, 4], [3, 2, 2, 3, 2, 1, 2, 3, 2, 2, 3], [2, 6, 2, 4, 6, 4, 3], [4, 4, 3, 4, 4, 4, 3], [3, 3, 4, 3, 1, 1, 3, 2], [1, 1, 5, 4, 2, 2, 2, 3, 3], [1, 3, 2, 4, 5, 4, 1, 4], [1, 12, 3, 6, 1, 3], [1, 9, 4, 6, 1, 3], [2, 5, 3, 1, 4, 2, 3], [3, 3, 2, 2, 2, 4], [4, 2, 2, 5, 4, 3], [6, 5, 6, 5, 3], [18, 4, 6, 2], [19, 1, 7, 1]]
    ])
    // 50 * 50
    nonograms.push([
      [[4, 3, 3, 4], [4, 1, 3, 3, 3], [2, 2, 2, 1, 5], [2, 7, 1, 1, 2, 3, 2, 3], [1, 5, 1, 10, 3, 3, 3], [3, 7, 2, 11, 4], [4, 1, 4, 5, 1, 3], [2, 4, 1, 1, 2, 7, 3, 4], [2, 4, 1, 1, 9, 1, 10], [3, 1, 3, 1, 1, 1, 8, 10], [14, 10, 10], [7, 1, 6, 6, 1, 1, 2, 4], [9, 1, 4, 6, 4, 3, 4], [1, 7, 6, 3, 3, 1, 1, 5], [3, 1, 3, 1, 4, 3], [2, 4, 1, 3, 4, 1, 1, 1], [2, 4, 2, 1, 4, 1, 4, 2, 1], [9, 2, 1, 1, 1, 3, 4, 1], [8, 5, 1, 1, 2, 7], [8, 2, 3, 1, 3, 8, 3, 1, 1], [10, 1, 4, 3, 13, 2], [3, 6, 3, 3, 1, 1, 18], [1, 10, 4, 1, 5, 13], [1, 8, 1, 3, 1, 6, 1, 1, 1, 1, 3], [3, 3, 2, 2, 8, 5, 3, 2], [1, 3, 2, 1, 4, 5, 3, 2, 1], [1, 4, 3, 3], [5, 3, 2, 2, 6], [2, 1, 3, 2, 3, 3, 5, 1, 4], [8, 5, 3, 1, 12, 3], [4, 2, 6, 2, 1, 16, 2], [1, 14, 4, 7, 2], [1, 6, 12, 4], [1, 4, 4, 6, 1, 1, 2], [1, 7, 3, 4, 3, 1], [1, 1, 5, 1, 2, 1, 1], [7, 1, 1, 1, 2, 1, 3], [7, 1, 10, 2, 7, 1, 1, 4, 3], [15, 2, 13, 1, 3], [14, 3, 7, 6, 1, 3], [3, 1, 3, 1, 4, 7, 3], [3, 3, 3, 1, 2, 13, 4], [3, 9, 1, 17], [6, 10, 3, 11], [7, 9, 1, 1, 7, 2], [1, 1, 1, 1, 2, 4, 3, 1, 6], [3, 3, 4, 3, 1, 4, 6, 2], [3, 1, 1, 2, 4, 1, 6, 2], [21, 1, 7, 3], [25, 7, 3]],
      [[6, 1, 3, 2, 3, 4], [4, 1, 7, 4, 4], [2, 1, 3, 3, 9, 2, 6, 2, 1], [2, 3, 3, 4, 1, 3, 5, 2, 1], [7, 5, 1, 1, 7, 3, 2], [14, 3, 7, 2, 2], [1, 1, 20, 3, 6, 3, 2], [2, 4, 4, 11, 2, 3, 2, 4, 2], [7, 5, 11, 2, 3, 4, 4], [8, 1, 4, 2, 5, 4], [3, 2, 1, 2, 1, 7, 5], [3, 2, 4, 3, 5, 1, 2], [3, 4, 5, 1, 1, 1, 13], [6, 1, 3, 3, 5, 10, 2], [4, 2, 2, 5, 4, 3, 4], [1, 5, 1, 1, 3, 1, 3, 2], [4, 3, 1, 1, 1, 3, 3, 3, 2], [5, 1, 4, 6, 6, 2], [4, 1, 1, 2, 1, 6, 1, 1, 9], [4, 1, 1, 6, 4, 1, 9], [1, 2, 8, 3, 5, 2], [2, 1, 4, 1, 3, 3], [1, 1, 3, 3, 1, 1, 4], [4, 1, 3, 1, 4], [4, 4, 1, 6, 5], [5, 3, 3, 1, 1, 1], [2, 9, 1, 6, 3, 5, 1, 5], [3, 13, 2, 6, 4], [6, 14, 4, 5], [14, 1, 3, 3, 3, 1], [2, 5, 6, 4, 2, 3], [2, 5, 2, 4, 8, 3, 1], [1, 2, 7, 8, 3, 2, 1], [1, 4, 1, 7, 3, 3, 6, 1], [1, 1, 1, 6, 6, 7], [3, 3, 6, 1, 5, 5], [2, 2, 1, 5, 1, 5, 8], [2, 2, 17, 6], [2, 1, 1, 1, 5, 12, 13], [3, 1, 3, 2, 5, 1, 10], [10, 4, 1, 7, 9], [6, 2, 1, 6, 2, 9], [7, 4, 4, 2, 1, 9], [8, 5, 4, 1, 1, 3, 4], [1, 4, 4, 2, 5, 1, 1, 1, 3, 2], [3, 6, 2, 8, 2, 1, 3], [3, 7, 1, 4, 3, 3, 4, 1], [5, 9, 3, 3, 11, 4], [3, 4, 3, 1, 4, 4, 7, 3], [2, 3, 3, 5, 4, 6, 2]]
    ])
    // nonograms.forEach(item => console.log(new Nonograms(item)))
  </script>

</body>
</html>